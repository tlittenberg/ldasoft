<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LDASoft: FisherGalaxy Manual</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="GBMCMC.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LDASoft
   </div>
   <div id="projectbrief">LISA Data Analysis Software</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_gbfisher_README.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">FisherGalaxy Manual </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md35"></a>
Input file format</h1>
<p>Space-separated ASCII file, one source per row. Columns are <a class="anchor" id="params"></a> </p><pre class="fragment">f (Hz) |  df/dt (s^-2) | co-latitude (rad) | longitude (rad) | amplitude | inclination (rad) | polarization angle (rad) | ref phase (rad)`
</pre><ul>
<li><code>f</code>: the gravitational wave frequency when observations begin. Related to the orbital period via <code>f = 2/P</code></li>
<li><code>df/dt</code>: the (constant) first time derivative of the frequency. Related to orbital period via <b>FIXME</b></li>
<li><code>co-latitude</code> polar sky coordinate.</li>
<li><code>longitude</code> azimuthal sky coordinate.</li>
<li><code>amplitude</code> gravitational wave amplitude. Related to frequency, chirp mass, and distance via <code>A = 2 M^5/3 (PI*f)^2/3 / D_L</code></li>
<li><code>inclination</code> angle of orbital angular momentum vector <code>L</code> w.r.t. the line of sight. Ranges from <code>0</code> to <code>PI</code>. A value of <code>PI/2</code> corresponds to an edge-on (i.e. eclipsing) binary. For random orientation the parameter should be distributed uniformly in <code>COS(inclination)</code> from <code>U[-1,1]</code>.</li>
<li><code>polarization angle</code> angle describing the decomposition of the GW signal into <code>h+</code> and <code>hx</code>. Ranges from <code>U[0,PI]</code>.</li>
<li><code>ref phase</code> phase of the binary orbit when observations begin. Ranges from <code>U[0,2PI]</code>.</li>
</ul>
<h2><a class="anchor" id="autotoc_md36"></a>
Note about sky location conventions</h2>
<p>The sky location parameters are in solar system barycenter ecliptic coordinates. <br  />
 We use co-latitude (<code>PI/2 - latitude</code>) so that its cosine is distributed from <code>U[-1,1]</code> Converting to these coordinates from galactic coordinates or RA and Dec can be done with <code>astropy</code>:</p>
<div class="fragment"><div class="line">import numpy as np</div>
<div class="line">from astropy import units as u</div>
<div class="line">from astropy.coordinates import SkyCoord</div>
<div class="line"> </div>
<div class="line">##############################</div>
<div class="line"># Using AM CVn as an example #</div>
<div class="line">##############################</div>
<div class="line"> </div>
<div class="line"># Convert from galactic to ecliptic coordinate</div>
<div class="line">amcvn_galactic = SkyCoord(140.23427349*u.deg, 78.93818425*u.deg, frame=&#39;galactic&#39;)</div>
<div class="line">amcvn_ecliptic = amcvn_galactic.transform_to(&#39;barycentrictrueecliptic&#39;)</div>
<div class="line"> </div>
<div class="line"># Convert from RA &amp; Dec to ecliptic coordinate</div>
<div class="line">amcvn_RAandDec = SkyCoord(188.72759585*u.deg, 37.62892244*u.deg, frame=&#39;icrs&#39;)</div>
<div class="line">amcvn_ecliptic = amcvn_RAandDec.transform_to(&#39;barycentrictrueecliptic&#39;)</div>
<div class="line"> </div>
<div class="line"># Extract sky angles and convert to colatitude</div>
<div class="line">colatitude = np.pi/2 - amcvn_ecliptic.lat.radian</div>
<div class="line">longitude = amcvn_ecliptic.lon.radian</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md37"></a>
Create orbit file with spacecraft ephimeredes</h1>
<p>Compute spacecraft coordinates during the observation time. This is a separate step to easily test different orbit models if numerically produced ephemerides are available. The process here uses the "Eccentric Inclined" analytic orbits similar to the LISA <a class="el" href="structData.html" title="Analaysis segment and meta data about size of segment, location in full data stream,...">Data</a> Challenges.</p>
<p><code>&gt;OrbitFile</code></p>
<p>Output files:</p>
<p><code>EccentricInclined.txt</code>: Cartesian coordinates x(t),y(t),z(t) in solar system barycentric coordinates of each spacecraft. Columns are </p><pre class="fragment">t (s) | SC1_x (m) | SC1_y (m) | SC1_z (m) | SC2_x (m) | SC2_y (m) | SC2_z (m) | SC3_x (m) | SC3_y (m) | SC3_z (m)
</pre> <h1><a class="anchor" id="autotoc_md38"></a>
Simulate data with detector response to full galaxy and Gaussian instrument noise</h1>
<p>Take a list of simulated sources and a set of spacecraft coordinates to simulate <a class="el" href="structTDI.html">TDI</a> data streams in the frequency domain for the given observing time. The process also filters the input galaxy for sources that are possibly detectable using a (generous) cut on signal to noise ratio SNR.</p>
<p><code>&gt;Galaxy &lt;source file&gt; &lt;orbit file&gt; &lt;observation time (s)&gt;</code></p>
<p>Output files:</p>
<p><code>&gt;Galaxy_XAE.dat</code>: Simulated Fourier domain <a class="el" href="structTDI.html">TDI</a> data with instrument noise and LISA response. Columns are </p><pre class="fragment">f (Hz) | Re{X(f)} | Im{X(f)} | Re{A(f)} | Im{A(f)} | Re{E(f)} | Im{E(f)} 
</pre><p> where the X channel is for a 4-link (single interferometer) data stream while A and E are the (approximately) orthogonal <a class="el" href="structTDI.html">TDI</a> channels constructed from the 6-link data</p>
<p><code>Bright.dat</code>: List of plausibly detectable sources from input population, using an approximate analytic expression for the signal to noise ratio, compared only to instrument noise, and thresholding on <code>SNR&gt;~2</code>. Columns are the same as the <a href="#params">input galaxy</a>.</p>
<h1><a class="anchor" id="autotoc_md39"></a>
Take data file and produce fit to confusion noise</h1>
<p>Use a running median to determine the frequency-dependent noise level of the input data.</p>
<p><code>&gt;Confusion_Fit &lt;data file&gt; &lt;orbit file&gt;</code></p>
<p>Output files:</p>
<p><code>Confusion_XAE_0.dat</code>: Resulting estimate of the overall and confusion noise levels. Columns are <a class="anchor" id="conf"></a> </p><pre class="fragment">f (Hz) | SnX(f) | SnX_conf(f) | SnA(f) | SnA_conf(f)
</pre><p> where <code>SnY</code> is the total (instrument plus confusion) noise power spectral density of channel <code>Y</code>, and <code>SnY_conf</code> is the confusion noise component. The <code>E</code> channel noises are identical to their <code>A</code> channel counterparts.</p>
<h2><a class="anchor" id="autotoc_md40"></a>
Intermediate data products for checking performance</h2>
<p><code>Xfit.dat</code></p>
<p><code>Xf.dat</code></p>
<p><code>Afit.dat</code></p>
<h1><a class="anchor" id="autotoc_md41"></a>
Compute residual data and detectable catalog</h1>
<p>Steps through list of input sources, computes their matched filter SNR compared to the current estimate of the confusion noise level, and selects those with an SNR&gt;7 as being detectable. Detectable binaries are removed from the data stream and the median noise estimate is recomputed.</p>
<p><code>&gt;Bright_Remove &lt;data file&gt; &lt;noise file&gt; &lt;source file&gt; &lt;orbit file&gt;</code></p>
<p>Output files:</p>
<p><code>Galaxy_XAE_R1.dat</code>: Residual frequency-domain data after detectable binaries have been removed. Columns are </p><pre class="fragment">f (Hz) | Re{X_res(f)} | Im{X_res(f)} | Re{A_res(f)} | Im{A_res(f)} | Re{E_res(f)} | Im{E_res(f)} 
</pre><p> where the X_res channel is for a 4-link (single interferometer) residual data stream while A_res and E_res are the (approximately) orthogonal <a class="el" href="structTDI.html">TDI</a> channels constructed from the 6-link data residuals.</p>
<p><code>Confusion_XAE_1.dat</code>: Final estimate of confusion noise after <code>SNR&gt;7</code> binaries have been removed from the data. Columns are the same as <a href="#conf">the inital estimate</a>.</p>
<p><code>Confusion_XAE_DS.dat</code>: Same as <code>Confusion_XAE_1.dat</code> but downsampled in frequency by a factor of <code>100</code> to make the file a more manageable size.</p>
<p><code>BrightX.dat</code>: List of detectable binares by a 4-link (single interferometer) detector. Columns are the same as <a href="#params">input galaxy</a>.</p>
<p><code>BrightAE.dat</code> List of detectable binares by a 6-link (three interferometer) detector. Columns are the same as <a href="#params">input galaxy</a>.</p>
<h2><a class="anchor" id="autotoc_md42"></a>
Intermediate data products for checking performance (overwriting output from &lt;tt&gt;ConfusionFit&lt;/tt&gt;)</h2>
<p><code>Xfit.dat</code></p>
<p><code>Xf.dat</code></p>
<p><code>Afit.dat</code></p>
<h1><a class="anchor" id="autotoc_md43"></a>
Estimate errors</h1>
<p>From list of detectable binaries, make final detection assessment using input confusion noise estimate and, for detectable binaries, estimate statistical error of parameter estimation with the Fisher approximation to the parameter covariance matrix. The process assesses tallies statistics of the catalog including overall number of detectable sources and the number which are well localized and/or with constrained orbital dynamics.</p>
<p><code>&gt;Fisher_Galaxy &lt;source file&gt; &lt;noise file&gt; &lt;4-link results file&gt; &lt;6-link results file&gt; &lt;orbit file&gt;</code></p>
<p>Output files:</p>
<p><code>&lt;4-link results file&gt;</code>,<code>&lt;6-link results file&gt;</code>: List of detectable binaries and estimated statistical uncertainties for [4/6]-link ([1/3] interferometer) mission. Columns are</p>
<div class="fragment"><div class="line">1. f (Hz) </div>
<div class="line">2. co-latitude (rad) </div>
<div class="line">3. longitude (rad) </div>
<div class="line">4. amplitude </div>
<div class="line">5. inclination (rad) </div>
<div class="line">6. polarization angle (rad) </div>
<div class="line">7. ref phase (rad)`</div>
<div class="line">8. df/dt (s^-2)</div>
<div class="line">9. d^2f/dt^2 (s^-3)</div>
<div class="line">10. sigma_f (fractional)</div>
<div class="line">11. sigma_co-latitude (radians)</div>
<div class="line">12. sigma_longitude (radians)</div>
<div class="line">13. sigma_amplitude (fractional)</div>
<div class="line">14. sigma_inclination (radians)</div>
<div class="line">15. sigma_polarization (radians)</div>
<div class="line">16. sigma_phase (radians)</div>
<div class="line">17. sigma_fdot (fractional)</div>
<div class="line">18. sigma_fddot (fractional)</div>
<div class="line">19. sigma_omega (sq. deg.)</div>
<div class="line">20. SNR</div>
</div><!-- fragment --><p><code>Brightest.dat</code>: 100 highest-SNR signals and their errors. Columns are the same as the above results files</p>
<p><code>DrawAE.dat</code>: <b>UNDER CONSTRUCTION</b> Fair draws from Gaussian using Fisher as covariance matrix for all detectable binaries. Colums are the same as <a href="#params">input galaxy</a>.</p>
<p><code>sky_all.dat</code>: 3D location (in cartesian coordinates with x-y plane in the ecliptic) of all detected binaries. Columns are </p><pre class="fragment">x_ecliptic (kpc) | y_ecliptic (kpc) |z_ecliptic (kpc)
</pre><p> <code>sky_3D.dat</code>: 3D location (in cartesian coordinates with x-y plane in the ecliptic) of all detected binaries <b>with distance measured to within 10% and sky location measured to within 1 sq. deg</b>. Columns are </p><pre class="fragment">x_ecliptic (kpc) | y_ecliptic (kpc) |z_ecliptic (kpc)
</pre><h1><a class="anchor" id="autotoc_md44"></a>
Example for input file &lt;tt&gt;FisherGalaxy_LDC_Radler_galaxy_key.dat&lt;/tt&gt;:</h1>
<div class="fragment"><div class="line">#Galaxy simulation</div>
<div class="line">GALAXYFILE=FisherGalaxy_LDC_Radler_galaxy_key.dat</div>
<div class="line"> </div>
<div class="line">#Observation time</div>
<div class="line">T=31457280 #1 year</div>
<div class="line"> </div>
<div class="line">#Calculate LISA orbits</div>
<div class="line">OrbitFile</div>
<div class="line"> </div>
<div class="line">#Simulate LISA response to galaxy</div>
<div class="line">Galaxy $GALAXYFILE EccentricInclined.txt $T</div>
<div class="line"> </div>
<div class="line">#Get initial estiamte of confusion noise level</div>
<div class="line">Confusion_Fit Galaxy_XAE.dat EccentricInclined.txt</div>
<div class="line"> </div>
<div class="line">#Find and regress resolvable binaries</div>
<div class="line">Bright_Remove Galaxy_XAE.dat Confusion_XAE_0.dat Bright.dat EccentricInclined.txt</div>
<div class="line"> </div>
<div class="line">#Compute error estimates for resolvable binaries</div>
<div class="line">Fisher_Galaxy BrightAE.dat Confusion_XAE_1.dat SigmasX.dat SigmasAE.dat DrawAE.dat EccentricInclined.txt </div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
